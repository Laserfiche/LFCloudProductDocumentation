<?xml version="1.0" encoding="utf-8"?>
<html MadCap:ignoredWords="Webhook;workflow" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title>Service Tasks in Business Processes | Laserfiche Forms | Process Automation</title>
        <meta name="description" content="Use service tasks in a business process if an action should be carried out by a computer. You can save data to a repository, send emails, or start workflows." />
    </head>
    <body>
        <h1>Service Tasks</h1>
        <p>
            <MadCap:concept term="Forms" />Service tasks represent actions by a service or program in a business process. One example of a service task is sending an email notification to users involved in the process.</p>
        <h2 class="topicheading">Why use a service task?</h2>
        <p>Use a service task for sending an email notification, saving a form to the repository, or posting process information using a webhook. If a user must take action as part of the task, use a <a href="User-Tasks.htm" title="Click here to learn more." alt="Click here to learn more.">user task</a> instead.</p>
        <h2 class="topicheading"><a name="Email"></a>Email Service Tasks</h2>
        <p>Email service tasks automatically send an email to one or more users at a specified point in the business process. These service tasks are useful if a user does not have to take action in a process but should still be kept informed of its progress.</p>
        <p>Email service tasks are represented by the following symbol: <img src="../Resources/Forms Images/email-service-task-icon.PNG" style="width: 23px;height: 18px;" /></p>
        <p><b>To send an email during a process</b>
        </p>
        <ol>
            <li>Open the <a href="Building-a-Process.htm" title="Click here to learn more." alt="Click here to learn more.">process designer</a> of the business process.</li>
            <li>Place an <b>Email Service Task</b> onto the canvas and connect it to the objects that precede and follow it in the process.</li>
            <li>Double-click the task to open its <b>Properties</b> dialog box.</li>
            <li>In the <b>Name</b> field, enter a descriptive name for the task. </li>
            <li>Under <b>Description</b>, describe the role that the task plays in the process.</li>
            <li>Fill in the <b>Send to</b> field. Use the <b>Show Reply to/CC/BCC</b> link to also fill in CC and BCC recipients. Click the <b>Insert Variable</b> button <img src="../Resources/Forms Images/insert variable.png" alt="Variable button (right arrow)" title="Variable button" /> to insert a <a href="List-of-Variables.htm" title="Click here to learn more." alt="Click here to learn more.">placeholder</a> for process or field information.</li>
            <li>For the <b>From</b> field, select from the available display names, or click <b>Manage display names</b> to create a new one. See <a href="../Resources/Settings/email-display-names.htm" title="Click to read more" alt="Click to read more">Email Display Names</a> for more information.</li>
            <li>Fill in the <b>Subject</b>, and <b>Body</b> fields.&#160;Click the <b>Insert Variable</b> button <img src="../Resources/Forms Images/insert variable.png" alt="Variable button (right arrow)" title="Variable button" /> to insert a <a href="List-of-Variables.htm" title="Click here to learn more." alt="Click here to learn more.">placeholder</a> for process or field information such as the name of the person who started the process, the submitter, any user task actions or comments, and field values.
            <ul><li>The <b>Previous submitter</b> variable refers to the last user or service that submitted a form.</li><li>The <b>Previous user submitter</b> variable refers to the last user who submitted a form. This ignores any more recent service tasks that submitted a form.</li><li>You can <a href="Using-the-Rich-Text-Editor-for-Custom-HTML-fields-and-Email-Notifications.htm" title="Learn to use the rich-text and custom HTML editor." alt="Learn to use the rich-text and custom HTML editor.">use rich-text</a> to compose the email body.</li></ul></li>
            <li><b>Optional</b>:&#160;Click the checkbox for <b>Include action history</b> to attach a PDF of the last 10 completed steps of action history in the email.</li>
        </ol>
        <h2 class="topicheading"><a name="WorkflowServiceTasks"></a>Workflow Service Tasks</h2>
        <p>Workflow service tasks start a workflow at a specific time in a business process. In the Workflow Service Task properties window, select the name of the workflow that should begin and the variables you want to send as inputs when the process reaches the service task. This service task lets you retrieve values from the completed workflow and assign those values to process variables.</p>
        <MadCap:snippetBlock src="../Resources/Snippets/migrating-form-tables-into-word-documents.flsnp" />
        <p>Workflow service tasks are represented by the following symbol: <img src="../Resources/Forms Images/workflow-service-task-icon.PNG" style="width: 36px;height: 27px;" /></p>
        <p><b>To start a workflow during a process</b>
        </p>
        <ol>
            <li>Open the <a href="Building-a-Process.htm" title="Click here to learn more." alt="Click here to learn more.">process diagram</a> of the business process from which you want to start a workflow.</li>
            <li>Place a <b>Workflow Service Task</b> onto the canvas and connect it to the objects that precede and follow it in the process.</li>
            <li>Double-click the task to configure its properties.</li>
            <li>In the <b>Name</b> field, enter a descriptive name for the task. </li>
            <li>Under <b>Description</b>, describe the role that the task plays in the process.</li>
            <li>In the <b>Workflow name</b> field, type or select the name of the workflow you want to start. If the workflow does not exist in the list, use the <b>Manage workflows</b> link to locate or create the workflow, and configure it for use with external processes. Once selected, you can use the <b>Open workflow</b> link to view the workflow and review how it will function.</li>
            <li>Select <b>Wait for the invoked workflow to finish running before continuing to run the current process</b> to pause this service task while the workflow runs, and resume when complete.<p class="note"><b>Note:</b> If not selected, output values can not be retrieved from the workflow, as the process will continue without waiting for the values.</p></li>
            <li>Configure input and output values. <a href="../Resources/Workflow/Workflow-Parameters.htm" title="Click to learn more." alt="Click to learn more.">Workflow parameters</a> must be configured in the workflow prior to using them in a business process.
            <ol><li>Configure the <b>Input values</b> with the <a href="Variables.htm" title="Click here to learn more." alt="Click here to learn more.">business process variables</a> or other data that the process will send to the workflow. </li><li>If you chose to have the process wait for the workflow to finish, configure which business process variables will be populated with the information returned from the workflow through the output parameters.</li></ol></li>
        </ol>
        <p><b>Field Mapping Guide</b>
        </p>
        <ul>
            <li>When passing workflow outputs to checkboxes, dropdowns, and radio buttons, if the option already exists in the variable, it will show as selected on the next form. If the option does not already exist, the behavior varies.
            	<ul><li>For checkboxes and dropdowns, an output value that does not exist will be appended to the options list and selected on the next form. </li><li>For radio buttons, an output value that does not exist will not lead to any selection or change in the list.</li></ul></li>
            <li> If a workflow output is mapped to a field inside a table or collection, all existing values for that field will be replaced. To change specific values in a table/collection:
            <ol><li>Pass the table variable to the workflow as a multi-value input parameter.</li><li>Make the desired changes to the row elements in the workflow.</li><li>Pass the token back via multi-value output parameter into the same field.</li></ol></li>
            <li>Any invalid value passed back will erase any existing value in the variable.</li>
            <li>Any blank value passed back will erase existing values</li>
        </ul>
        <p><b>Supported data types for workflow interactions:</b>
        </p>
        <ul>
            <li>Input values: Single line, Multi-line, Radio button, Checkbox (as a whole and all individual options), Dropdown, Address (as a whole and all individual fields), Number, Email, Date (with or without time), Time, Currency, Geolocation (as a whole and each individual sub-field), and any supported fields in tables and collections.</li>
            <li>Not supported: File upload, Rich text, Signature, and Custom HTML.</li>
            <li>Output values: Single line, Multi-line, Radio button, Checkbox (as a whole and all individual options), Dropdown, Address (individual fields), Number, Email, Date (with or without time), Time, Currency, Geolocation (individual sub-fields only), and any supported fields in tables and collections.</li>
        </ul>
        <p class="ex"><b>Example:</b> When a sales representative submits an initial inquiry form, a workflow runs that calculates a time estimate for the project, creates custom client documents in the repository, and creates a WebLink URL to the client documents. After the workflow finishes, it passes the URL back to business processes. Business processes then sends a new form to the sales representative with a link to the information packet.</p>
        <h2 class="topicheading"><a name="Rules"></a><a name="Rules-Service-Task"></a>Rules Service Task</h2>
        <p><a href="#Rules-Service-Task">#Rules-Service-Task</a>The Rules service task is an extremely powerful feature that allows you to use rules to manipulate variables within a process. </p>
        <p>Rules service tasks are represented by the following symbol: <img src="../Resources/Forms Images/Rules-Service-Task-icon.PNG" style="width: 36px;height: 27px;" /></p>
        <h3>To run a rule during a process</h3>
        <ol>
            <li>Open the <a href="Building-a-Process.htm" title="Click here to learn more." alt="Click here to learn more.">process diagram</a> of the process from which you want to run a rule.</li>
            <li>Place a <b>Rules Service Task</b> onto the canvas and connect it to the objects that precede and follow it in the process.</li>
            <li>Double-click the task to configure its properties.</li>
            <li>In the <b>Name</b> field, enter a descriptive name for the task. </li>
            <li>Under <b>Description</b>, describe the role that the task plays in the process.</li>
            <li>Select the type of <a href="../Resources/Rules/Rules.htm" title="Click here to learn more about rules." alt="Click here to learn more about rules.">rule</a> you wish to run.</li>
            <li>Select the rule to run.<ol><li>If the rule desired is not in the list, click the <b>Manage rules</b> link to open the <a href="../Resources/Rules/Rules.htm" title="Click here to learn more about rules." alt="Click here to learn more about rules.">Rules page</a> to create or troubleshoot your rule.</li><li>To veiw details or edit your rule, click the <b>Open selected rule</b> link.</li><li>Once the rule has been published, click the refresh button <img src="../Resources/Forms Images/refresh-icon.PNG" />to update the rule list or input/output value availability.</li></ol></li>
            <li>If the rule has input parameters, click the <b>Add input values</b> link to select the parameters to make available to the process.<ol><li>Select the necessary parameters, and click <b>Update</b> to add them to the process.</li><li>Configure which values will be passed to the rule. Use the variable picker to select from available variables within the process.</li></ol></li>
            <li>If the rule has output parameters, click the <b>Add output values</b> link to select the parameters to make available to the process.<ol><li>Select the necessary parameters, and click <b>Update</b> to add them to the process.</li><li>Configure which variables will be populated by the rule. Use the variable picker to select from available variables within the process.</li></ol></li>
        </ol>
        <h2 class="topicheading"><a name="Save"></a>Save to Repository Service Tasks</h2>
        <p>The Save to Repository service task save a copy of a particular form and its attachments to the Laserfiche repository. While the task attempts to preserve all data and maintain the basic layout of the form, there are limitations that are related to printing any web page. Please test the process, review the output, and verify that the output is sufficient for your business requirements.</p>
        <p class="note"><b>Note:</b>&#160;The Save To Repository task runs as a service process and does not have access to the user's cookies, browser storage, or any custom JavaScript on the form. This may create difficulties in rendering external sites <a href="Javascript-and-CSS/Displaying Documents in a Form.htm" title="Read more about displaying documents in a form" alt="Read more about displaying documents in a form">embedded in iframes</a> on a form.</p>
        <p>You can configure the following options for Save to Repository service tasks:</p>
        <ul>
            <li>The template and fields that the saved document will have. You can fill fields with values from form fields.</li>
            <li>When in the process the form submission document will be created.</li>
            <li>Whether the process will wait for the task to complete before proceeding to the next step(s) in the process.</li>
            <li>The document name, path, format, and relationships between the form and its attachments.</li>
        </ul>
        <p>Save to Repository service tasks are represented by the following symbol: <img src="../Resources/Forms Images/SaveToRepository-service-task.PNG" style="width: 27px;height: 21px;" /></p>
        <p style="font-weight: bold;">To save a form to a repository during a process</p>
        <ol>
            <li>Open the <a href="Building-a-Process.htm" title="Click here to learn more." alt="Click here to learn more.">process designer</a> of the business process.</li>
            <li>Place a <b>Save to Repository Service Task</b> onto the canvas and connect it to the objects that precede and follow it in the process.</li>
            <li>Double-click the task to configure its properties.</li>
            <li>In the <b>Name</b> field, enter a descriptive name for the task. </li>
            <li>Under <b>Description</b>, describe the role that the task plays in the process.</li>
            <li>Select <b>Allow process to continue before service task completes</b> if you want the process to start the Save to Repository task, then continue on to the next steps without waiting for the  task to complete. If this option is cleared, a failed Save to Repository task will suspend the entire process, meaning that later steps in the process will not be taken.</li>
            <li>Select <b>Generate Laserfiche pages when importing PDFs</b> to generate Laserfiche TIFF image pages when a PDF is imported.</li>
            <li>In the <b>Repository profile</b> drop-down list, select a repository profile.</li>
            <li>Under the <b>Save settings</b> section, select the form you want to save to the repository.<ul><li>If you select <b>Save the submitted form from this process step</b>, choose the form that was submitted at the step specified. If the step was an earlier step, the document saved to the repository will reflect the previous values submitted on the form.</li><li>If you select <b>Save a form with current process data</b>, the saved form will use the current values for each field.<p class="note"><b>Note:</b> If you want a document with specific formatting, you can create a copy of the original form, remove any fields that are not required, adjust the formatting, and use it with this setting to print the current process data.</p></li></ul></li>
            <li>After selecting between the two options in the previous step, select the form you want to save from the drop-down menu. If you selected <b>Save the submitted form from this process step</b>, you will also have to select the step/user task.</li>
        </ol>
        <p>Once you select a form from the drop-down list, options for configuring the form and any of its attachments will appear.</p>
        <ol>
            <li>In the <b>Document name</b> field, enter a name for the form submission document in the repository. Click the <b>Insert Variables</b> button <img src="../Resources/Forms Images/insert variable.png" alt="Variable button (right arrow)" title="Variable button" /> to insert a value from form or process variables into the name.</li>
            <li>In the <b>Save location</b> area:<ol><li> Under <b>Folder ID</b>, specify a folder in the repository to save into regardless of its path. This can be done by entering a valid folder ID, selecting from the variable picker, or using the folder picker.<p class="note"><b>Note:</b> Use this option if you always want to save documents to the same folder. Using the folder ID to select the folder will keep your process running smoothly even if that folder is moved or renamed in the repository.</p></li><li>Under <b>Additional Path</b>, specify an absolute path to where you would like the submissions to be saved. If Folder ID is blank, this path will be determined from the repository root. If Folder ID is set, this path will be below the specified folder.<p class="note"><b>Note:</b> Use this option if you want the folder to be dynamic based on values in the form submission. For example, this would be the right choice if you wanted to save submissions based on date</p></li></ol><p class="ex">For example, to place any form submissions in a date-based structure, you might select a folder from the folder ID called "new clients", then use variables to create sub-folders based on the date and information from the form itself.</p></li>
            <li>Under <b>Save Options</b>, select to save the document as a <b>PDF</b>&#160;or <b>TIFF</b>.
			<ol><li>Alternatively, select <b>No Form</b> to save a document that has metadata but no actual image or electronic document components. If you clear this option, the folder path you specified above will be created. (You can apply metadata to this folder with the <b>Configure fields</b> and <b>Parent folder fields</b> options below.) You may want to clear this option if you're only using a form to gather the metadata that you will apply to a folder where the form's attachments will be saved.</li></ol></li>
            <li>Select <b>Include action history</b> to include the action history from preceding user tasks on the form.</li>
            <li>Select <b>Save business process data as XML</b> if you would like to save an XML copy of the business process with the document. </li>
            <li>Under <b>Fields</b>, click <b>Configure fields</b> to select a <a href="https://doc.laserfiche.com/laserfiche.documentation/en-us/Default.htm#Fields_and_Templates.htm" title="Learn more about template and fields" alt="Learn more about template and fields">template or field</a> to apply to the document.
		<ol style="list-style-type: lower-roman;"><li>In the <b>Configure fields</b> dialog box, choose a template from the drop-down menu or click <b>Add/remove fields</b> to choose the fields you want applied to the form.</li><li>You can specify a value for each template field and any added fields. Click the <b>Insert Variables</b> button <img src="../Resources/Forms Images/insert variable.png" alt="Variable button (right arrow)" title="Variable button" />to populate any field with form or process variables.</li><p class="note"><b>Note</b>: For <a href="Form-Fields/Radio-Button.htm" title="Click here to learn more." alt="Click here to learn more.">radio button or drop-down fields</a> on your form, you must have <a href="Form-Fields/Radio-Button.htm#perform" title="Click here to learn more." alt="Click here to learn more.">assigned values to the field's choices</a> if you want to save those field's values as metadata in a repository. In addition, the field you want to populate in the entry's metadata must be a <a href="https://doc.laserfiche.com/laserfiche.documentation/en-us/Default.htm#Fields_and_Templates.htm" title="Learn more about list fields, a type of field that can be assigned to repository entries." alt="Learn more about list fields, a type of field that can be assigned to repository entries.">list field</a>, and the values available in the list field must be identical to the values available in your form's drop-down field.</p><li>Click <b>Done</b> when you have finished configuring the fields. </li></ol></li>
            <li>Under <b>Parent folder template</b>, click <b>Configure fields</b> to select a <a href="https://doc.laserfiche.com/laserfiche.documentation/en-us/Default.htm#Fields_and_Templates.htm" title="Learn more about templates and fields" alt="Learn more about templates and fields">template and fields</a> to apply to the folder the form submission document is saved in.           <ol style="list-style-type: lower-alpha;"><li>In the <b>Configure fields</b> dialog box, choose a template from the drop-down menu or click <b>Add/remove fields</b> to choose the fields you want applied to the form.</li><li>You can specify a value for each template field and any added fields. Click the <b>Insert Variables</b> button <img src="../Resources/Forms Images/insert variable.png" alt="Variable button (right arrow)" title="Variable button" />to populate any field with form or process variables.</li><li><p class="note"><b>Note</b>: For <a href="Form-Fields/Radio-Button.htm" title="Click here to learn more." alt="Click here to learn more.">radio button or drop-down fields</a> on your form, you must have <a href="Form-Fields/Radio-Button.htm#perform" title="Click here to learn more." alt="Click here to learn more.">assigned values to the field's choices</a> if you want to save those field's values as metadata in a repository. In addition, the field you want to populate in the entry's metadata must be a <a href="https://doc.laserfiche.com/laserfiche.documentation/en-us/Default.htm#Fields_and_Templates.htm" title="Learn more about list fields, a type of field that can be assigned to repository entries." alt="Learn more about list fields, a type of field that can be assigned to repository entries.">list field</a>, and the values available in the list field must be identical to the values available in your form's drop-down field.</p></li><li>Click <b>Done</b> when you have finished configuring the fields. 
</li></ol></li>
            <li>If your form has <a href="Form-Fields/File-Upload.htm" title="Learn more about the File Upload field" alt="Learn more about the File Upload field">file uploads</a>, a tab will appear for each upload. Configure these tabs as follows: 
        	<ol style="list-style-type: lower-alpha;"><li>In the <b>Document name</b> field, enter a name for the file upload document in the repository. Click the <b>Insert variable</b> <img src="../Resources/Forms Images/insert variable.png" alt="Variable button (right arrow)" title="Variable button" /> button to insert the value from form or process variables into the name.</li><li>Next to <b>Path</b>, select whether the file upload document should be saved in the <b>Parent form location</b> or an <b>Other location</b>. If you select <b>Other location</b>, click the <b>Path</b> <b>...</b> button to browse to a path.</li><li>In the <b>Volume</b> field select a volume for the document to be saved in. </li><li>In the <b>Document relationships</b> field, choose the relationship you want to apply between the uploaded file and the submitted form. <a href="https://doc.laserfiche.com/laserfiche.documentation/en-us/Default.htm#Links.htm" title="Learn more about document relationships" alt="Learn more about document relationships">Learn more about document relationships</a>. </li><li>Under <b>Fields</b>, click <b>Configure fields</b> to select a <a href="https://doc.laserfiche.com/laserfiche.documentation/en-us/Default.htm#Fields_and_Templates.htm" title="Learn more about templates and fields" alt="Learn more about templates and fields">template and fields</a> to apply to the uploaded file. In the <b>Configure fields</b> dialog box, choose a template from the drop-down menu and/or click <b>Add/remove fields</b> to choose the fields you want applied to the uploaded file. You can specify a value for each template field and any added fields. Click the <b>Insert Variable</b> button <img src="../Resources/Forms Images/insert variable.png" alt="Variable button (right arrow)" title="Variable button" />to populate the field with form or process variables.</li></ol></li>
        </ol>
        <p class="note"><b>Note:</b>&#160;When saving data from a process to a metadata field in a repository entry, the format of the data must match the metadata field's format. Attempting to save mismatching formats (e.g. saving text data to a number field) will cause a "Bad field value" error.</p>
        <h3>Save to Repository Considerations</h3>
        <p>Unless the <b>Allow process to continue before service task completes</b> is selected, your process will become suspended at a Save to Repository task under the following conditions:</p>
        <ul>
            <li>If the task fails to create the document in the repository. </li>
            <li>If the task is unable to upload attachments to the repository.</li>
            <li>If any uncaught exception errors occur when the PDF is being generated.</li>
        </ul>
        <p>The first two issues most commonly occur either when the built in ProcessAutomation user has not been granted access to the desired repository locations, or when fields are populated with incompatible data types or are to long for the destination fields.</p>
        <p class="note"><b>Note:</b>&#160;When the Save to Repository task does fail, any documents or files created before the point of failure will be left behind. If you retry the step in the process without checking, duplicate documents can be created. For example, if saving a form with attachments fails after the PDF is generated and saved, but while attempting to upload the attachments, the PDF document will not be deleted.</p>
        <h2 class="topicheading">Outflow Tab</h2>
        <p>All tasks have an <a href="Outflows.htm" title="Learn to configure outflows for a task." alt="Learn to configure outflows for a task.">Outflow tab</a> which lets you specify which pathway the process should take after the task has completed. </p>
    </body>
</html>