<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="Default.Complete">
    <head>
    </head>
    <body>
        <h1>Update Word Document</h1>
        <p style="text-align: center;">
            <img src="Images/updateWordDocumentCanvas.PNG" title="Update Word Document activity" alt="Update Word Document activity" />
        </p>
        <p>This activity performs a series of modifications on a Microsoft Word document.</p>
        <p>To set up this activity:</p>
        <ol>
            <li>
                <MadCap:snippetText src="../../Snippets/Drag Activities.flsnp" />
            </li>
            <li>
                <MadCap:snippetText src="../../Snippets/Activity Name and Description Sentence.flsnp" />
            </li>
            <li>In the <b>Document to Modify</b> property box, select the Word document you want to modify from the following options:<ul><li><b>Server attachment</b>: Select an electronic document attached in <a href="../../Assets/Files.htm" title="Click here to learn more." alt="Click here to learn more.">Files</a>. Click the <b>Browse</b> button (ellipsis) <img src="../../../Images/Icon_Ellipsis_White.png" /> to browse to an attachment.</li><li><b>Activity</b>: Attach a document created by an activity in your workflow. To attach a document:<ol><li>Click the <b>Edit</b> button <img src="../../../Images/Icon_Pencil_Blue.png" /> to select an entry from an activity earlier in your workflow definition.</li><li>Hover over the activity you want to select the source from.</li><li>Select a source in the activity.</li></ol></li></ul></li>
            <li>In the Modifications property box, click <b>New...</b>.</li>
            <li>Select a type of modification: <b>Find Replace</b>, <b>Simple Field Merge</b>, or <b>Table Field Merge</b> and configure the options for that type of modification.<MadCap:dropDown><MadCap:dropDownHead><MadCap:dropDownHotspot>Find Replace</MadCap:dropDownHotspot></MadCap:dropDownHead><MadCap:dropDownBody><p>Automate Word's find and replace functionality. Your document does not have to contain merge fields or any special formatting for this option to work.</p><p class="ex"><b>Example</b>:&#160;The Acme Insurance Company has a new client information packet they like to customize with the client's and the account manager's name. When a new client is brought in, their name and their account manager's name are added to the metadata on the Client's folder. Once those two fields are filled out, a workflow starts that runs an <b>Update Word Document</b> activity. This activity automatically looks for <b>ClientName</b> and <b>AccountManagerName</b> in each document in the folder and replaces those values with the client and account manager's actual names.</p><p>To configure Find Replace:</p><ol><li>Click <b>New...</b>.</li><li>In the <b>New Modification</b> dialog box, ensure <b>Find Replace</b> is selected in the Type drop-down.</li><li>Next to <b>Find what</b>, type the characters you want workflow to find in the document. Click the right arrow <img src="../../../Images/Icon_Arrow_Right_White.png" /> to add a <a href="../Tokens-Regex/Tokens.htm" title="Click here to learn more." alt="Click here to learn more.">token</a>.</li><li>Next to <b>Replace with</b>, type the characters workflow will replace the found values with. Click the right arrow <img src="../../../Images/Icon_Arrow_Right_White.png" /> to add a token.</li><li>If you select the <b>Case sensitive</b> option, the activity will only find results with the same capitalization pattern as the value you type next to <b>Find what</b>. Clear this option to find matches regardless of capitalization.</li><li>If you select the <b>Match whole word</b> option, the activity will only find whole words, not partial words. For example, if you select this option and configure the activity to find the word <b>book</b>, it will find all instances of the word book but not <b>bookmark</b> or <b>booking</b>.</li><li>If you select the <b>Use regular expressions</b> option, you can use regular expressions to extract specific information from a token you've added to your <b>Find</b> value. For example, if you put an address token in the Find what field, you can use regular expressions to only find the zip code from the address. <a href="../Tokens-Regex/Regular-Expressions.htm" title="Click here to learn more." alt="Click here to learn more.">Learn more about regular expressions</a></li><li>Click <b>OK</b> to confirm your changes.</li></ol></MadCap:dropDownBody><br /><br /></MadCap:dropDown><MadCap:dropDown><MadCap:dropDownHead><MadCap:dropDownHotspot>Simple Field Merge</MadCap:dropDownHotspot></MadCap:dropDownHead><MadCap:dropDownBody><p>If you have a document that is going to be updated by a database as well as a workflow, or if you have more complicated updating needs, select the <b>Simple Field Merge</b> option. To configure <b>Simple Field Merge</b>:</p><ol><li>Select <b>New...</b>.</li><li>In the <b>New Modification</b> dialog box, ensure <b>Simple Field Merge</b> is selected in the <b>Type</b> drop-down.</li><li>You can populate the table automatically or manually.<p>To populate the table automatically:</p><ol><li>Select <b>Import…</b>.</li><li>Select one of the following options:<ul><li><b>Import From Document</b>: Select a document attached in <a href="../../Assets/Files.htm" title="Click here to learn more." alt="Click here to learn more.">Files</a>.</li><li><b>Import From Disk</b>: Select a file on your local machine.</li></ul></li><li>Click <b>OK</b>.</li></ol><p>To populate the table manually:</p><ol><li>Select <b>Add Field</b> to add a merge field.</li><li>Type the name of the field under <b>Field Name</b>.</li><li>Type the value that the field will be replaced with when the workflow runs under <b>Value</b>. Click the right arrow <img src="../../../Images/Icon_Arrow_Right_White.png" /> to add a <a href="../Tokens-Regex/Tokens.htm" title="Click here to learn more." alt="Click here to learn more.">token</a>.</li><li>Select the type of data for the field under <b>Type</b>. Setting the type is important if you are inserting a token with a value that could be one of multiple types. In most cases, leaving <b>Default</b> in this column is sufficient.</li><li>Select the <b>Default</b> link to provide custom formatting for the field, including default formatting, checkbox fields, or barcodes.<p class="note"><b>Note</b>: You can define custom properties for barcodes not listed in the <b>Barcode Type</b> drop-down menu.</p></li></ol></li><li>Below the table of fields are several options for cleaning up the Word document after the merge runs. You can remove empty paragraphs, fields, regions, containing fields, and static fields. You can also clear mail merge settings configured in the <b>Mail Merge</b> wizard. Select the <b>Replace non merge fields</b> option if you have other types of fields in your document (e.g., text wrapped in double curly brackets <b>{{}}</b>) that you want this activity to replace.</li></ol></MadCap:dropDownBody></MadCap:dropDown><MadCap:dropDown><MadCap:dropDownHead><MadCap:dropDownHotspot>Table Field Merge</MadCap:dropDownHotspot></MadCap:dropDownHead><MadCap:dropDownBody><p>Populate a Word document's table using a data source. If you select this option you must have a <a href="Run-Business-Rules.htm">Run Rule activity</a> that retrieves the data you want to insert into the table from a <a href="../../Entities/lookup-tables.htm">lookup table</a> or other data source earlier in your workflow.</p><p>To configure Table Field Merge:</p><ol><li>Select <b>New...</b>.</li><li>In the <b>New Modification</b> dialog box, ensure <b>Table Field Merge</b> is selected in the Type drop-down.</li><li>Next to <b>Activity</b>, click the <b>Edit</b> button <img src="../../../Images/Icon_Pencil_Blue.png" /> to specify the values you want to insert into the Word table.</li><li>Next to <b>Merge Region Name</b>, type the name of the region that corresponds to the table in Word. The region is the value you specified after the "TableStart" and "TableEnd" fields in your table.</li><li>After you select the file in step 3, populate the table with all the merge fields. You can do this manually by selecting <b>Add Field</b> and typing the name of the field in the text boxes under Field Name manually or selecting <b>Import field names from document</b> below the table to populate the table automatically.</li><li>In the <b>Value</b> column, select a token. The field will be replaced with the token's value when the workflow runs.</li><li>In the <b>Type</b> column, select the type of data that will be entered into the field. Setting the type is important if you are inserting a token whose value could be one of multiple types, for example, it could be interpreted as a string or number, and you want to ensure Word interprets the token correctly. In most cases, leaving <b>Default</b> in this column is sufficient.</li><li>In the <b>Options</b> column, click <b>Default</b> to provide custom formatting for the field. You have the option to use the default formatting, render the field as a checkbox, or render it as a barcode. You can define custom properties for barcodes not listed in the <b>Barcode Type</b> drop-down menu.</li><li>To add a field to the table in the <b>New Modification</b> dialog box, click the <b>Add Field</b> link below the table. To remove a field from the table, click the <b>Remove</b> link in the field's row.</li><li>Below the table of fields are several options for cleaning up the Word document after the merge runs. You can remove empty paragraphs, fields, regions, containing fields, and static fields. You can also clear mail merge settings configured in the <b>Mail Merge</b> wizard. Select the <b>Replace non merge fields</b> option if you have other types of fields in your document (e.g., text wrapped in double curly brackets <b>{{}}</b>) that you want this activity to replace.</li></ol></MadCap:dropDownBody></MadCap:dropDown></li>
            <li>Click <b>OK</b>.</li>
            <li>In the <b>Output Document Options</b> property box, select additional actions on the document.<ul><li><b>Create new document</b>: Creates a new document with the changes made by the activity instead of updating the existing document.<ul><li><b>Convert to PDF</b>: Converts the resulting document to PDF format.</li><li><b>Rename Document</b>: Changes the name of the document to the value you provide here.</li></ul></li><li><b>Overwrite Source Documents (activity sourced files only)</b>: Overwrites the source document when you select <b>Activity</b> in the drop-down menu in the <b>Document to Modify</b> property box.</li><li><b>Emit email token</b>: Creates a token containing the resulting content.
                </li><li><b>Report serialization warnings</b>: Displays warnings from serialization in the Messages tab in the instance report.</li></ul></li>
        </ol>
        <MadCap:snippetBlock src="../../Snippets/disable-activity.flsnp" />
        <MadCap:snippetBlock src="../../Snippets/migrating-form-tables-into-word-documents.flsnp" />
    </body>
</html>