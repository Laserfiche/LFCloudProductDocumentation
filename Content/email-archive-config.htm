<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
    </head>
    <body>
        <h1>
            <MadCap:concept term="Email Archive" />Editing the <MadCap:variable name="DoNotTranslate.Laserfiche Email Archive" /> Service's Configuration File</h1>
        <p>Use the configuration file found here:&#160;<b>C:\Program Files\Laserfiche\EmailArchive\config.xml</b> to configure:</p>
        <ul>
            <li>Running the <MadCap:variable name="DoNotTranslate.Laserfiche Email Archive" /> service on multiple threads</li>
            <li>A location where the database file can cache any emails the service cannot process immediately or that fail to import. The database file will also cache pieces of large emails that have been sent in parts until the parts arrive or a timeout period has been reached. <a href="email-archive-cache.htm" title="Click to learn more." alt="Click to learn more.">Learn more about mail caching</a>.</li>
            <li>TLS settings </li>
            <p class="note"><b>Note:</b> The TLS options are also configurable in the <b>Email Archive Service Settings</b>.</p>
        </ul>
        <p class="note"><b>Note:</b> You must restart the <MadCap:variable name="DoNotTranslate.Laserfiche Email Archive" /> service for changes to the Config.xml file to take effect.</p>
        <p><b>Options in the Config.xml file</b>
        </p>
        <table style="width: 100%;border-left-width: medium;border-left-color: #ffffff;border-right-width: medium;border-right-color: #ffffff;border-top-width: medium;border-top-color: #ffffff;border-bottom-width: medium;border-bottom-color: #ffffff;" class="tablesorter">
            <col style="width: 214px;" />
            <col style="width: 68px;" />
            <col style="width: 106px;" />
            <col />
            <thead>
                <tr>
                    <th class="tableheading"><b>Name</b>
                    </th>
                    <th class="tableheading"><b>Type</b>
                    </th>
                    <th class="tableheading"><b>Default Value</b>
                    </th>
                    <th class="tableheading"><b>Notes</b>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="tabletext">MaxEmailSize*</td>
                    <td class="tabletext">Long</td>
                    <td class="tabletext">20971520</td>
                    <td class="tabletext">The maximum email size in bytes that <MadCap:variable name="DoNotTranslate.Laserfiche Email Archive" /> can accept.</td>
                </tr>
                <tr>
                    <td class="tabletext">RequireTLS*</td>
                    <td class="tabletext">Boolean</td>
                    <td class="tabletext">False</td>
                    <td class="tabletext">If the <MadCap:variable name="DoNotTranslate.Laserfiche Email Archive" /> Service requires TLS or not. If true, <MadCap:variable name="DoNotTranslate.Laserfiche Email Archive" /> and the email server must be configured to use TLS. </td>
                </tr>
                <tr>
                    <td class="tabletext">Thumbprint*</td>
                    <td class="tabletext">String</td>
                    <td class="tabletext">&#160;</td>
                    <td class="tabletext">Thumbprint of the certificate used by the <MadCap:variable name="DoNotTranslate.Laserfiche Email Archive" /> Service TLS. This will be ignored if RequireTLS is false. </td>
                </tr>
                <tr>
                    <td class="tabletext">ClientCertificateRequired*</td>
                    <td class="tabletext">Boolean</td>
                    <td class="tabletext">False</td>
                    <td class="tabletext">If the <MadCap:variable name="DoNotTranslate.Laserfiche Email Archive" /> Service requires the client who sends emails to the service to send a certificate for TLS negotiation. This will be ignored if RequireTLS is false.</td>
                </tr>
                <tr>
                    <td class="tabletext">CheckClientCertificate*</td>
                    <td class="tabletext">Boolean</td>
                    <td class="tabletext">False</td>
                    <td class="tabletext">If the <MadCap:variable name="DoNotTranslate.Laserfiche Email Archive" /> Service will check certificate revocation for the TLS negotiation. This will be ignored if RequireTLS false.</td>
                </tr>
                <tr>
                    <td class="tabletext">ThreadCount</td>
                    <td class="tabletext">Integer</td>
                    <td class="tabletext">4</td>
                    <td class="tabletext">
                        <p>The maximum number of threads the <MadCap:variable name="DoNotTranslate.Laserfiche Email Archive" /> Service can create when importing to <MadCap:variable name="DoNotTranslate.Laserfiche" />.</p>
                    </td>
                </tr>
                <tr>
                    <td class="tabletext">Location*</td>
                    <td class="tabletext">String</td>
                    <td class="tabletext">&#160;</td>
                    <td class="tabletext">The location of the database file that caches emails. If this option is left empty, C:\ProgramData\Laserfiche\EmailArchiveService\cache.db will be used. <a href="email-archive-cache.htm" title="Click to learn more." alt="Click to learn more.">Learn more</a>.</td>
                </tr>
                <tr>
                    <td class="tabletext">QueueCapability</td>
                    <td class="tabletext">Integer</td>
                    <td class="tabletext">1000</td>
                    <td class="tabletext">The capability for incoming emails to be processed. If there are more incoming emails than specified in this parameter, they will be put into a database file to be cached first and will then be processed when the service is idle. <a href="email-archive-cache.htm" title="Click to learn more." alt="Click to learn more.">Learn more</a>.</td>
                </tr>
                <tr>
                    <td class="tabletext">PartialMessageReceiveTimeout*</td>
                    <td class="tabletext">Integer</td>
                    <td class="tabletext">30 minutes</td>
                    <td class="tabletext">Timeout for collecting partial messages, in minutes. After this timeout, any remaining partial messages will be imported to <MadCap:variable name="DoNotTranslate.Laserfiche" />.</td>
                </tr>
                <tr>
                    <td class="tabletext">RetryInterval*</td>
                    <td class="tabletext">Integer</td>
                    <td class="tabletext">1440 minutes (1day)</td>
                    <td class="tabletext">The interval at which the <MadCap:variable name="DoNotTranslate.Laserfiche Email Archive" /> Service will try to process emails cached in the database, in minutes. </td>
                </tr>
                <tr>
                    <td class="tabletext">CompactInterval*</td>
                    <td class="tabletext">Integer</td>
                    <td class="tabletext">1440 minutes (1day)</td>
                    <td class="tabletext">The interval at which the database file will be compacted, in minutes. E.g., Given the default value, the database file will be compacted once a day.</td>
                </tr>
                <tr>
                    <td class="tabletext">Port*</td>
                    <td class="tabletext">Integer</td>
                    <td class="tabletext">25</td>
                    <td class="tabletext">
                        <MadCap:concept term="Import Agent" />Available in <MadCap:variable name="DoNotTranslate.Import Agent" /> 10.3.1 and later: The TCP port for <MadCap:variable name="DoNotTranslate.SMTP" /> communication. This option is configurable through  <b>Email Archive Service Settings</b> accessed from the <MadCap:variable name="DoNotTranslate.Laserfiche Email Archive" /> Configuration dialog box. Restart the <MadCap:variable name="DoNotTranslate.Laserfiche Email Archive" /> Service after modifying the value. Additionally, ensure you have a firewall exception for this port.  </td>
                </tr>
            </tbody>
        </table>
        <p>* The starred items are only applicable for <MadCap:variable name="DoNotTranslate.Laserfiche Email Archive" /> configurations that use <MadCap:variable name="DoNotTranslate.SMTP" /> and are not applicable to <MadCap:variable name="DoNotTranslate.Laserfiche Email Archive" /> configurations that run using IMAP.</p>
    </body>
</html>